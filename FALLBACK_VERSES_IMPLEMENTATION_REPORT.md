# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∏—Ö–∞

## –ó–∞–¥–∞—á–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∏—Ö–∞, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–π —Å—Ç–∏—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## –†–µ—à–µ–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π API endpoint
**–§–∞–π–ª**: `/app/api/verses/find-next/route.ts`

```typescript
export async function POST(request: NextRequest) {
  // –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∏—Ö–∞:
  // 1. –ò—â–µ—Ç —Å—Ç–∏—Ö —Å –Ω–æ–º–µ—Ä–æ–º –±–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –≤ —Ç–æ–π –∂–µ –≥–ª–∞–≤–µ
  // 2. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—â–µ—Ç –ø–µ—Ä–≤—ã–π —Å—Ç–∏—Ö –≤ —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ
  // 3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Å—Ç–∏—Ö –∏–ª–∏ –æ—à–∏–±–∫—É 404
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–π API endpoint
**–§–∞–π–ª**: `/app/api/verses/get/route.ts`

#### –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã GET –∏ POST:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—Ç–∏—Ö–∞
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ —Å—Ç–∏—Ö–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç:
  1. –°–ª–µ–¥—É—é—â–∏–π —Å—Ç–∏—Ö –≤ —Ç–æ–π –∂–µ –≥–ª–∞–≤–µ
  2. –ü–µ—Ä–≤—ã–π —Å—Ç–∏—Ö –≤ —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `fallback: true` –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ fallback:
```json
{
  "success": true,
  "verse": { /* –¥–∞–Ω–Ω—ã–µ —Å—Ç–∏—Ö–∞ */ },
  "found": false,
  "fallback": true,
  "message": "–°—Ç–∏—Ö 1.47 –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–∫–∞–∑–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π: 2.1"
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
**–§–∞–π–ª**: `/app/components/VerseGenerator.tsx`

#### –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ fallback:
- –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —Å—Ç–∏—Ö–æ–º

```typescript
if (dbData.fallback) {
  console.log('üì¢ Fallback verse used:', dbData.message);
  setError(`‚ÑπÔ∏è ${dbData.message}`);
  setTimeout(() => setError(null), 5000);
}
```

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—Ç–∏—Ö–∞:
1. **–ó–∞–ø—Ä–æ—Å —Å—Ç–∏—Ö–∞ 1.47** (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. **–ü–æ–∏—Å–∫ –≤ —Ç–µ–∫—É—â–µ–π –≥–ª–∞–≤–µ**: –∏—â–µ—Ç —Å—Ç–∏—Ö–∏ > 47 –≤ –≥–ª–∞–≤–µ 1
3. **–ü–æ–∏—Å–∫ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ**: –∏—â–µ—Ç –ø–µ—Ä–≤—ã–π —Å—Ç–∏—Ö –≤ –≥–ª–∞–≤–µ 2
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∏—Ö 2.1 —Å —Ñ–ª–∞–≥–æ–º `fallback: true`

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:
- –ó–∞–ø—Ä–æ—Å 1.47 ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 2.1 ‚úÖ
- –ó–∞–ø—Ä–æ—Å 1.50 ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 2.1 ‚úÖ
- –ó–∞–ø—Ä–æ—Å 1.46 ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 1.46 (–Ω–æ—Ä–º–∞–ª—å–Ω–æ) ‚úÖ
- –ó–∞–ø—Ä–æ—Å 99.1 ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 (–≥–ª–∞–≤–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) ‚úÖ

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç API endpoints:
```bash
üß™ Testing fallback verse functionality...

Test 1: Requesting verse 1.47 (should fallback to 2.1)...
  ‚úÖ Fallback successful: –°—Ç–∏—Ö 1.47 –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–∫–∞–∑–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π: 2.1
  üìñ Returned verse: 2.1

Test 2: Requesting verse 1.50 (should fallback to 2.1)...
  ‚úÖ Fallback successful: –°—Ç–∏—Ö 1.50 –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–∫–∞–∑–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π: 2.1
  üìñ Returned verse: 2.1

Test 3: Requesting existing verse 1.46 (should return normally)...
  ‚úÖ Normal response: 1.46

Test 4: Requesting verse from non-existent chapter 99.1...
  ‚úÖ Correctly returned 404 for non-existent chapter
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤:
- ‚úÖ Fallback –¥–ª—è 1.47: —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Fallback –¥–ª—è 1.50: —Ä–∞–±–æ—Ç–∞–µ—Ç  
- ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è 1.46: —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ 404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –≥–ª–∞–≤—ã: —Ä–∞–±–æ—Ç–∞–µ—Ç

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –æ—à–∏–±–æ–∫ 404 –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∏—Ö–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å—Ç–∏—Ö
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ç–æ–º, —á—Ç–æ –ø–æ–∫–∞–∑–∞–Ω fallback —Å—Ç–∏—Ö

### 2. –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è:
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç —á—Ç–µ–Ω–∏—è –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è

### 3. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏—Ö–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ fallback

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞:
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã fallback
- –ß–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback —Å—Ç–∏—Ö–æ–≤

## –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. **`/app/api/verses/find-next/route.ts`** - –Ω–æ–≤—ã–π endpoint –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—Ç–∏—Ö–∞
2. **`/app/api/verses/get/route.ts`** - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ fallback
3. **`/app/components/VerseGenerator.tsx`** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ fallback –≤ UI
4. **`/test_fallback_verses.js`** - —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞!**

**–ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∏—Ö–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –≥–ª–∞–≤–∞–º–∏
- –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ–ª—å—à–µ –Ω–µ –≤–∏–¥—è—Ç –æ—à–∏–±–æ–∫ 404 –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∏—Ö–æ–≤
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å—Ç–∏—Ö
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–µ–∫—Å—Ç—É —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–π
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—ã–º –∫ –æ—à–∏–±–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å fallback —Å—Ç–∏—Ö–æ–≤ —É—Å–ø–µ—à–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–∞! üéâ
